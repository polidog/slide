<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="../lib/talkie.min.css">
  <link rel="stylesheet" href="../lib/talkie-default.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/monokai_sublime.min.css">
</head>
<body>


<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  backface="./img/webrtc.svg">
# ã¯ã˜ã‚ã¦ã®WebRTC

ğŸ˜ 2017/05/20 - [@polidog](https://twitter.com/polidog)


</template>

<template type="text/x-markdown"
  layout="bullets">

![]()
<img src="https://avatars1.githubusercontent.com/u/284778?v=3&s=160" style="border-radius: 50%;">

* [@polidog](https://twitter.com/polidog)
* [tavii.com Inc](http://tavii.com)
* PHPer, ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å°‘ã—æ›¸ãã¾ã™ã€‚
* æ¸…æ°´åŒºå‡ºèº«



</template>

<template type="text/x-markdown"
  layout="bullets"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  backface="./img/symfony.png">
## å®£ä¼

Symfony Meetupã‚’æ±äº¬ã§é–‹å‚¬ã—ã¦ã„ã¾ã™ã€‚
OOPã¨ã‹DDDã¨ã‹ãã®è¾ºèˆˆå‘³ã‚ã‚‹æ–¹ã¯ãœã²ï¼


</template>

<template type="text/x-markdown"
  layout="bullets">

## ã¯ã˜ã‚ã«

ãªãœWebRTCã«èˆˆå‘³ã‚’æŒã£ãŸã®ã‹ï¼Ÿ


</template>

<template type="text/x-markdown"
  layout="bullets"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  backface="img/js.jpg">
## JSã§ç°¡å˜ã«ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã¤ãã‚Œã‚‹ã‹ã‚‰


</template>

<template type="text/x-markdown"
  layout="bullets">
## ä»Šæ—¥è©±ã™ã“ã¨

* WebRTCã¨ã¯ï¼Ÿ
* MediaStream
* RTCPeerConnection
* NATã‚’è¶…ãˆã‚‹ãŸã‚ã«
* ãƒ‡ãƒ¼ã‚¿ãƒãƒ£ãƒãƒ«
* PeerJSã‚’ä½¿ã£ãŸWebRTCã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã‚‹


</template>

<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  invert="true">
# WebRTCã¨ã¯ï¼Ÿ


</template>

<template type="text/x-markdown"
  layout="bullets">

## WebRTCã¨ã¯ï¼Ÿ

- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®API
- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã§ãƒ“ãƒ‡ã‚ªãƒãƒ£ãƒƒãƒˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰ãŒå¯èƒ½


</template>

<template type="text/x-markdown"
  layout="bullets">

![](img/trend.png)

* 2011å¹´ãã‚‰ã„ã‹ã‚‰é¨’ãŒã‚Œã¦ã¯ã˜ã‚ã¦ã„ã‚‹ï¼Ÿ
* æœ€è¿‘ã¯ã‚ã¾ã‚Šè©±ã—èã‹ãªã„æ°—ã‚‚ã™ã‚‹ãƒ»ãƒ»ãƒ»ã€‚


</template>

<template type="text/x-markdown"
  layout="bullets">

## ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹

- [Google Hangout](https://hangouts.google.com/)
- [Slack](https://https://slack.com/)(ãƒ“ãƒ‡ã‚ªãƒãƒ£ãƒƒãƒˆéƒ¨åˆ†)
- [appear.in](https://appear.in/)


ãƒ“ãƒ‡ã‚ªãƒãƒ£ãƒƒãƒˆé–¢é€£ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã ã„ãŸã„WebRTCæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">

## å¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶

- Chrome
- FireFox
- Opera


</template>

<template type="text/x-markdown"
  layout="bullets">
## WebRTCã®ä¸»ãªAPI

- MediaStream API: éŸ³å£°ã‚„å‹•ç”»ã‚’æ‰±ã†ãŸã‚ã®API
- RTCPeerConnection API: éŸ³å£°ã‚„å‹•ç”»ã®é€šä¿¡ã®ãŸã‚ã®API
- RTCDataChanel API : ãƒ‡ãƒ¼ã‚¿é€šä¿¡ç”¨ã®API



</template>

<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  invert="true">
# MediaStream


</template>

<template type="text/x-markdown"
  layout="bullets">

# MediaStream API

- å‹•ç”»ã€éŸ³å£°ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨ã—ã¦æ‰±ã†JavaScript API
- getUserMediaã‚’ã¤ã‹ã£ã¦MediaStreamã‚’å–å¾—ã™ã‚‹
- videoã‚¿ã‚°ã«æ¸¡ã›ã°å‹•ç”»å†ç”Ÿã™ã‚‹ã—ã€RTCPeerConnectionã«æ¸¡ã™ã“ã¨ã‚‚ã§ãã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">
<img src="img/mediastream.svg" style="height:500px">




</template>

<template type="text/x-markdown"
  layout="bullets">
## <a href="demo/mediastream.html" target="blacnk" >demo</a>



</template>

<template type="text/x-markdown"
  layout="code">
## ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ã¿ã‚‹

``` JavaScript
var config = {
  audio: false,
  video:  true
}

navigator.mediaDevices.getUserMedia(config)
  .then(function(stream){
    var video = document.getElementById('video-display');
    video.src = window.URL.createObjectURL(stream);
  }).catch(function(error){
    console.log(error)
  }
```



</template>

<template type="text/x-markdown"
  layout="bullets">

## ãŸã£ãŸæ•°è¡Œã§videoè¡¨ç¤ºã§ãã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">

## navigator.mediaDevices

- æœ€è¿‘ã®ãƒ–ãƒ©ã‚¦ã‚¶ã ã¨navigator.mediaDevices.getUserMedia()ã‚’ä½¿ãˆã°ã‚ˆã„
- éå»ã¯ãƒ™ãƒ³ãƒ€ãƒ¼ã”ã¨prefixã¤ã„ã¦ãŸã€‚
- ã—ã‹ã‚‚Promiseã§ã¯ãªã„ã€‚
- Firefox47, Chrome51ä»¥é™ãªã‚‰navigator.mediaDevices


</template>

<template type="text/x-markdown"
  layout="code">

``` JavaScript
navigator.getUserMedia  = navigator.getUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMediaã€€|| navigator.webkitGetUserMedia;

function getUserMedia(options) {

  if ('getUserMedia' in navigator.mediaDevices) {
    return navigator.mediaDevices.getUserMedia(options)
  }

  return new Promise(function(resolve, reject){
    navigator.getUserMedia(options, resolve, reject)
  });

}

```


</template>

<template type="text/x-markdown"
  layout="bullets">

ã¡ãªã¿ã«æœ€æ–°ã®Chromeã ã¨ã“ã“ã®ãƒ‡ãƒ¢ã¨ã‹å‹•ã‹ãªã„ãƒ»ãƒ»ãƒ»ã€‚
<a href="https://www.html5rocks.com/ja/tutorials/getusermedia/intro/" target="_blank">HTML5 ã§ã®æ˜ åƒã¨éŸ³å£°ã®å–å¾—</a>



</template>

<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  invert="true">
# RTCPeerConnection


</template>

<template type="text/x-markdown"
  layout="bullets">

## RTCPeerConnection

- RTCPeerConnectionã¯ã€P2Pã®æ¥ç¶šã®ç¢ºç«‹ã€æ¥ç¶šã®ç¶­æŒã®ãŸã‚ã®å‡¦ç†ã‚’æä¾›ã™ã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">
<img src="img/peerconnection.svg" style="height:500px">



</template>

<template type="text/x-markdown"
  layout="bullets">

## ã‚·ã‚°ãƒŠãƒªãƒ³ã‚°

Peer-to-Peeré€šä¿¡ã‚’å§‹ã‚ã‚‹å‰ã«ã€ãŠäº’ã„ã®æƒ…å ±ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã®å‡¦ç†

<img src="img/sing.svg" style="height:200px">



</template>

<template type="text/x-markdown"
  layout="bullets">

## SDP(Session Description Protocol)

P2Pã®æ¥ç¶šæƒ…å ±ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå«ã‚€éŸ³å£°ã€å‹•ç”»ã®å½¢å¼
- IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒãƒ¼ãƒˆç•ªå·
- é€šä¿¡ã§ä½¿ç”¨ã•ã‚Œã‚‹å¸¯åŸŸ


</template>

<template type="text/x-markdown"
  layout="bullets">

## demo
<img src="img/amy.svg" style="height:200px">

</template>

<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  invert="true">
# NATã‚’è¶…ãˆã‚‹ãŸã‚ã«


</template>

<template type="text/x-markdown"
  layout="bullets">
## ICE

NATè¶…ãˆã‚‹ãŸã‚ã«å¿…è¦ãªã‚‚ã®

- RTCPeeerConnectionã¯ICEã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æŒã¤
- ICEã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆã®çµ„åˆã‚ã›(å€™è£œ)ã‚’åé›†ã™ã‚‹
ã€€


</template>

<template type="text/x-markdown"
  layout="bullets">
## STAN


- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªIPã¨ãƒãƒ¼ãƒˆã‚’è¿”ã™ã‚µãƒ¼ãƒ
- STUNã‚µãƒ¼ãƒã«ã¤ã„ã¦ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãŒã„ãã¤ã‹ã‚ã‚‹
- ã‚‚ã¡ã‚ã‚“è‡ªå‰ã§ç«‹ã¦ã¦ã‚‚å¤§ä¸ˆå¤«

```
stun.l.google.com:19302 // google
stun.services.mozilla.com:3478 / Mozilla
stun.skyway.io:3478 / NTTCommunications
```


</template>

<template type="text/x-markdown"
  layout="bullets">
<img src="https://html5experts.jp/wp-content/uploads/2014/03/webrtc_nat_1.png">

<a href="https://html5experts.jp/mganeko/5554/" target="_blank">å£ã‚’è¶Šãˆã‚ï¼WebRTCã§NAT/Firewallã‚’è¶Šãˆã¦é€šä¿¡ã—ã‚ˆã†</a>


</template>

<template type="text/x-markdown"
  layout="bullets">

## TURN

Peer-to-Peeré€šä¿¡ãŒã§ããªã„ã¨ãã«ä»£ã‚ã‚Šã«ãƒªãƒ¬ãƒ¼ã™ã‚‹ã‚µãƒ¼ãƒ


</template>

<template type="text/x-markdown"
  layout="bullets">
![](https://html5experts.jp/wp-content/uploads/2014/03/webrtc_fw_1.png)

<a href="https://html5experts.jp/mganeko/5554/" target="_blank">å£ã‚’è¶Šãˆã‚ï¼WebRTCã§NAT/Firewallã‚’è¶Šãˆã¦é€šä¿¡ã—ã‚ˆã†</a>


</template>

<template type="text/x-markdown"
  layout="bullets">

## ICEã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæµã‚Œ

1. è‡ªèº«ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’OSã«ç¢ºèª
2. å¤–éƒ¨ã®STUNã‚µãƒ¼ãƒã«å•ã„åˆã‚ã›ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã¨ãƒãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹
3. P2Pæ¥ç¶šã«å¤±æ•—ã—ãŸå ´åˆã«TURNã‚µãƒ¼ãƒã‚’åˆ©ç”¨ã—ã¦ãƒªãƒ¬ãƒ¼ã™ã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">

## Trickle ICE

- ICEã®æ‹¡å¼µ
- ICEã®å€™è£œãŒè¦‹ã¤ã‹ã£ãŸã‚‰ã™ãã«ç›¸æ‰‹ã¨äº¤æ›ã™ã‚‹
- ç›¸æ‰‹ã¨äº¤æ›ã§ããŸã‚‰ã€ãã®æƒ…å ±ã‚’ä½¿ã£ã¦ã™ãã«æ¥ç¶šè©¦è¡Œã™ã‚‹


</template>

<template type="text/x-markdown"
  layout="bullets">

## DEMO

## ãã®ä»–

- SRTPã‚„SRTCPã‚„DTLSã¯ã¾ãŸä»Šåº¦ãƒ»ãƒ»ãƒ»


</template>

<template type="text/x-markdown"
  layout="title"
  backface-size="contain"
  backface-filter="blur(0px) opacity(.2)"
  invert="true">

# ãƒ‡ãƒ¼ã‚¿ãƒãƒ£ãƒãƒ«


</template>

<template type="text/x-markdown"
  layout="bullets">

# æœ€å¾Œã«


</template>

<template type="text/x-markdown"
  layout="bullets">

- WebRTCã¯å¥¥ãŒæ·±ã„ã€‚
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã¡ãã‚’å¾—ã‚‹ãŸã‚ã®å…¥ã‚Šå£ã¨ã—ã¦ã„ã„ã‹ã‚‚
- æ¥½ã—ã„

æœ¬è²·ã„ã¾ã—ã‚‡ã†ï¼


</template>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script src="../lib/talkie.min.js"></script>
<script>
  var talkie = Talkie({
    wide: false
  })
  talkie.key('space').subscribe(talkie.next$)
  talkie.key('s').subscribe(talkie.next$)
  talkie.key('n').subscribe(talkie.next$)
  talkie.key('a').subscribe(talkie.prev$)
  talkie.key('p').subscribe(talkie.prev$)

  document.addEventListener('DOMContentLoaded', function() {
    talkie.changed.subscribe(function(current) {
      console.info(talkie.notes[current.getAttribute('data-page')])
    })
  })
</script>
</body>
</html>
